<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="title">the eestrecord</title>
<meta name="description" content="Mora Jai Box (from blue prince) Editor.">
<meta name="author" content="Eest Software">
<link rel="image_src" href="/theestrecord.png"/>
<meta name="keywords" content="HTML, CSS, JavaScript, Eest, Software, Mora Jai Box, Mora Jai, Blue Prince, Bpp, Silenceman, Say what?">
<link rel="shortcut icon" href="theestrecord.ico" type="image/x-icon"> 

<style>

body {
  background-color: #272727;
  color: #FDFCFC;
}

.center {
 margin:auto;
 justify-content: center;
 display: flex;
}

.tilebutton{
 width:176px;
 height:176px;
 position:relative
}


.red {filter: hue-rotate(240deg) brightness(75%) saturate(170%)}
.red:hover {filter: hue-rotate(240deg) brightness(55%) saturate(170%)}
.green{filter: saturate(170%)}
.green:hover {filter: brightness(85%) saturate(170%)}
.black{filter: grayscale(100%) brightness(40%) saturate(170%)}
.black:hover {filter: grayscale(100%) brightness(30%) saturate(170%)}
.violet{filter: hue-rotate(160deg) brightness(60%) saturate(200%)}
.violet:hover {filter: hue-rotate(160deg) brightness(45%) saturate(200%)}
.pink{filter: hue-rotate(180deg)}
.pink:hover {filter: hue-rotate(180deg) brightness(85%)}
.yellow{filter: hue-rotate(300deg) brightness(145%) saturate(200%)}
.yellow:hover {filter: hue-rotate(300deg) brightness(120%) saturate(200%)}
.orange{filter: hue-rotate(280deg) brightness(115%) saturate(150%)}
.orange:hover {filter: hue-rotate(280deg) brightness(100%) saturate(150%)}
.blue{filter: hue-rotate(70deg) brightness(100%) saturate(180%)}
.blue:hover {filter: hue-rotate(70deg) brightness(85%) saturate(200%)}
.white{filter: grayscale(100%) brightness(170%)}
.white:hover {filter: grayscale(100%) brightness(150%)}
.gray{filter: grayscale(100%)}
.gray:hover {filter: grayscale(100%) brightness(90%)}

    </style> 
   </head>


<body>

<div id="box" style="position:absolute;display: flex;left:32.5%" class="center">
<img src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaibox.png"></img>


<input type ="image" class="tilebutton green" id="tile0;0" style="top:214px;right:804px" onClick="tilePress(0, 0)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton red" id="tile0;1" style="top:214px;right:776px" onClick="tilePress(0, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton black" id="tile0;2" style="top:214px;right:749px;transform: scaleX(-1)" onClick="tilePress(0, 2)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<br>
<input type ="image" class="tilebutton white" id="tile1;0" style="top:425px;right:1331px" onClick="tilePress(1, 0)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton violet" id="tile1;1" style="top:425px;right:1303px" onClick="tilePress(1, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton yellow" id="tile1;2" style="top:425px;right:1276px;" onClick="tilePress(1, 2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<br>
<input type ="image" class="tilebutton orange" id="tile2;0" style="top:635px;right:1859px;transform: rotate(-90deg)" onClick="tilePress(2, 0)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton pink" id="tile2;1" style="top:635px;right:1831px" onClick="tilePress(2, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton blue" id="tile2;2" style="top:635px;right:1804px;transform: scaleX(-1) rotate(-90deg)" onClick="tilePress(2, 2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>

</div>

<script>
const Tiles = Object.freeze({
     GRAY: 0,
     WHITE: 1,
     GREEN: 2,
     BLACK: 3,
     VIOLET: 4,
     YELLOW: 5,
     PINK: 6,
     ORANGE: 7,
     RED: 8,
     BLUE: 9

});

var grid = [[Tiles.BLACK, Tiles.BLACK, Tiles.WHITE], [Tiles.VIOLET, Tiles.RED, Tiles.WHITE], [Tiles.PINK, Tiles.BLUE, Tiles.GRAY]]

function tilePress(y, x) {
  var tileColor = grid[y][x];
  switch(tileColor) {
    case 0: break;
    case 1:
        grid[y][x] = Tiles.GRAY;
        let allowedColors = [Tiles.GRAY, Tiles.WHITE];
        let convertTo = {0: 1, 1: 0};
        convertTile(y, x - 1, allowedColors, convertTo);
        convertTile(y, x + 1, allowedColors, convertTo);
        convertTile(y - 1, x, allowedColors, convertTo);
        convertTile(y + 1, x, allowedColors, convertTo);
        break;
    case 2:
        var oppositeX = 1;
        if (x == 2) {oppositeX = 0;} else if (x == 0) {oppositeX = 2;}
        var oppositeY = 1;
        if (y == 2) {oppositeY = 0;} else if (y == 0) {oppositeY = 2;}
        var oppositeTile = grid[oppositeY][oppositeX];
        grid[y][x] = oppositeTile;
        grid[oppositeY][oppositeX] = Tiles.GREEN;
        break;
   case 3:
        var altGrid = [grid[y][2], grid[y][0], grid[y][1]];
        for (let i = 0; i < grid[y].length; i++) { grid[y][i] = altGrid[i]; }
        break;
   case 4:
        if (y >= grid.length - 1) {break;}
        var southTile = grid[y + 1][x];
        grid[y][x] = southTile;
        grid[y + 1][x] = Tiles.VIOLET;
        break;
    case 5:
        if (y <= 0) {break;}
        var northTile = grid[y - 1][x];
        grid[y][x] = northTile;
        grid[y - 1][x] = Tiles.YELLOW;
        break;
    case 6:
        let adjacentTiles = [[], [], []];//CODING THIS WAS TORTURE
        var i = 0;
        for (let rY = y - 1; rY < y + 2;rY++) { 
          if (rY < 0 || rY > grid.length - 1) {
            adjacentTiles[i] = [-1, -1, -1];
            i++;
            continue;
          }
          for (let rX = x - 1; rX < x + 2; rX++) {
            if (rX < 0 || rX > grid[rY].length - 1) {adjacentTiles[i].push(-1);continue;}
            adjacentTiles[i].push(grid[rY][rX]);
          }
          i++;
        }

        var nextTile = adjacentTiles[0][0];
         for (let rX = 0; rX < adjacentTiles[0].length; rX++) {
           var returnValue = rotateTile(rX, 0, nextTile, adjacentTiles);
           adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
         for (let rY = 1; rY < adjacentTiles.length; rY++) {
           var returnValue = rotateTile(2, rY, nextTile, adjacentTiles);
           adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
         for (let rX = 1; rX > -1; rX--) {
           var returnValue = rotateTile(rX, 2, nextTile, adjacentTiles);
          adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
         for (let rY = 1; rY > -1; rY--) {
           var returnValue = rotateTile(0, rY, nextTile, adjacentTiles);
           adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
        if (adjacentTiles[1][0] == -1 && y == 0) { adjacentTiles[1][2] = nextTile; } 
        else if (adjacentTiles[1][2] == -1 && y == 0) { adjacentTiles[2][1] = nextTile; }
        else if (adjacentTiles[0][1] == -1 && y == 0) { adjacentTiles[1][2] = nextTile; }

        i = 0;
        for (let rY = y - 1; rY < y + 2;rY++) { 
          if (rY < 0 || rY > grid.length - 1) {i++;continue;}
          var j = 0;
          for (let rX = x - 1; rX < x + 2; rX++) {
            if (rX < 0 || rX > grid[rY].length - 1) {j++;continue;}
            grid[rY][rX] = adjacentTiles[i][j];
            j++;
          }
          i++;
        }
        break;
     case 7:
        var neighbouringTiles = [];
        if (y > 0) {neighbouringTiles.push(grid[y - 1][x]);}
        if (y < grid.length - 1) {neighbouringTiles.push(grid[y + 1][x]);}
        if (x > 0) {neighbouringTiles.push(grid[y][x - 1]);}
        if (x < grid[y].length - 1) {neighbouringTiles.push(grid[y][x + 1]);}
        let popularity = {};
        for (let i = 0; i < neighbouringTiles.length; i++) {
          if (Object.keys(popularity).indexOf(neighbouringTiles[i].toString()) < 0) { popularity[neighbouringTiles[i]] = 0; }
          popularity[neighbouringTiles[i]]++;
        }

        var maximum = [0, 7]
        for (let i = 0; i < Object.keys(popularity).length; i++) {
         var tile = Object.keys(popularity)[i];
         if (popularity[tile] < maximum[0]) {continue;}
         else if (popularity[tile] == maximum[0]) {maximum[1] = 7;continue;}
          
         maximum[0] = popularity[tile];
         maximum[1] = parseInt(tile);
        }
        grid[y][x] = maximum[1];
        break;
      case 8:
        for (let i = 0; i < grid.length; i++) {
           for (let j = 0; j < grid[i].length; j++) {
             convertTile(j, i, [Tiles.WHITE, Tiles.BLACK], {1: 3, 3: 8});
           }
        }
        break;
      case 9:
         if (grid[1][1] == Tiles.BLUE) {return;}
         tilePress(1, 1);
         return;
  }
  renderBox();
}

function convertTile(y, x, allowedColors, convertTo) {
  if (y >= grid.length || y < 0 || x >= grid[y].length || x < 0) {return;}
  var isColor = false;
  for (let i = 0; i < allowedColors.length; i++) {
    if (allowedColors.indexOf(grid[y][x]) < 0) {continue;}
    isColor = true;
    break;
  }
  if (!isColor) {return;}
  grid[y][x] = convertTo[grid[y][x]];
} 

function rotateTile(x, y, nextTile, adjacentTiles) {
    var xDir = 0;
    if (y == 0 && x< 2) {xDir = 1;}
    else if(y== 2 && x> 0) {xDir = -1;}
    var yDir = 0;
    if (x== 0 && y> 0) {yDir = -1;}
    else if(x== 2 && y< 2) {yDir = 1;}
             
    var tile = nextTile;
    nextTile = adjacentTiles[y+ yDir][x+ xDir]; 

    if (nextTile == -1) {nextTile = tile;tile = -1;}
    if (tile == -1) { return [adjacentTiles, nextTile];}
    adjacentTiles[y+ yDir][x+ xDir] = tile;
    return [adjacentTiles, nextTile];
}


function renderBox() {
  var colorNames = Object.keys(Tiles);
  for (var y = 0; y < grid.length; y++) {
    for (var x = 0; x < grid[y].length; x++) {
      var tileColor = grid[y][x];
      document.getElementById("tile" + y + ";" + x).className = "tilebutton " + colorNames[tileColor].toLowerCase();
   }
  }
}

renderBox();
</script>


</body>
</html>

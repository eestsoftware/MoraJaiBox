<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="title">Mora Jai Box</title>
<meta name="description" content="Mora Jai Box (from blue prince) Editor.">
<meta name="author" content="Eest Software">
<link rel="image_src" href="/theestrecord.png"/>
 <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<meta name="keywords" content="HTML, CSS, JavaScript, Eest, Software, Mora Jai Box, Mora Jai, Blue Prince, Bpp, Silenceman, Say what?">
<link rel="shortcut icon" href="theestrecord.ico" type="image/x-icon"> 

<style>

body {
  font-family: Times New Roman;
  background-color: #272727;
  color: #FDFCFC;
}

div {
 text-align:center;
}

hr {
 width:90%;
 text-align:left;
 margin-left:0"
}

.center {
  position:relative;
  margin:auto;
  overflow-x:hidden;
  top:0;
  bottom:0;
  left:0;
  right:0;
}

.tilebutton{
 width:176px;
 height:176px;
 position:relative
}

.cornercircle{
 width:195px;
 height:195px;
 position:relative;
}

.noHover{
    pointer-events: none;
}


.red {filter: hue-rotate(240deg) brightness(75%) saturate(170%)}
.red:hover {filter: hue-rotate(240deg) brightness(55%) saturate(170%)}
.green{filter: saturate(170%)}
.green:hover {filter: brightness(85%) saturate(170%)}
.black{filter: grayscale(100%) brightness(40%) saturate(170%)}
.black:hover {filter: grayscale(100%) brightness(30%) saturate(170%)}
.violet{filter: hue-rotate(160deg) brightness(60%) saturate(200%)}
.violet:hover {filter: hue-rotate(160deg) brightness(45%) saturate(200%)}
.pink{filter: hue-rotate(180deg)}
.pink:hover {filter: hue-rotate(180deg) brightness(85%)}
.yellow{filter: hue-rotate(300deg) brightness(145%) saturate(200%)}
.yellow:hover {filter: hue-rotate(300deg) brightness(120%) saturate(200%)}
.orange{filter: hue-rotate(280deg) brightness(115%) saturate(150%)}
.orange:hover {filter: hue-rotate(280deg) brightness(100%) saturate(150%)}
.blue{filter: hue-rotate(70deg) brightness(100%) saturate(180%)}
.blue:hover {filter: hue-rotate(70deg) brightness(85%) saturate(200%)}
.white{filter: grayscale(100%) brightness(170%)}
.white:hover {filter: grayscale(100%) brightness(150%)}
.gray{filter: grayscale(100%)}
.gray:hover {filter: grayscale(100%) brightness(90%)}

.blankColor{filter: none}
.blankColor:hover {filter: brightness(70%)}
    </style> 
   </head>


<body>
<div id="menubar" style="width:120%;height:150px;background-color:#1B1D27;display:flex;overflow:hidden;text-align:center;position:fixed;z-index:5;top:0;left:0;right:0;bottom:0;margin-right:auto;margin-left:auto;justify-content:center">

<input type ="image" class="tilebutton white" style="display:inline-block;bottom:15px;transform: scale(0.75);color:#000000" onClick="showMenu('help')"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"><h1 class="noHover" style="font-size:48px;color:#000000;position:relative;top:15px;right:134px">Help</h1></input>

<input type ="image" class="tilebutton blue" style="display:inline-block;bottom:15px;right:105px;transform: scale(0.75);color:#000000" onClick="showMenu('edit')"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"><h1 class="noHover" style="font-size:48px;color:#000000;position:relative;top:15px;right:239px">Edit</h1></input>

<input type ="image" class="tilebutton green" style="display:inline-block;bottom:15px;right:200px;transform: scale(0.75);color:#000000" onClick="showMenu('load')"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"><h1 class="noHover" style="font-size:48px;color:#000000;position:relative;top:15px;right:340px">Load</h1></input>


<input type ="image" class="tilebutton gray" style="display:inline-block;bottom:15px;right:310px;transform: scale(0.75);color:#000000" onClick="showMenu('presets')"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"><h1 class="noHover" style="font-size:42px;color:#000000;position:relative;top:21px;right:462px;">Presets</h1></input>


<input type ="image" class="tilebutton violet" style="display:inline-block;bottom:15px;right:445px;transform: scale(0.75) scaleX(-1);color:#000000" onClick="showMenu('saved')"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"><h1 class="noHover" style="font-size:48px;color:#000000;position:relative;top:15px;right:595px">Saved</h1></input>


</div>
<br><br><br><br><br><br>


<div id="solved" class="blue" style="position:fixed;width:100%;height:80px;top:165px;left:0;background-color:#00FF25;bottom:45px;right:5px;color:#000000;display:none;z-index:2">
<h1 style="position:relative;font-size:64px;bottom:40px" id="solvedtext"> Big fat box Solved !!!</h1>

<input type ="image" class="tilebutton gray" id="solvedretrybutton" style="bottom:-50px;left:0px;position:fixed;background-color:#121212;transform: scale(0.475)" onClick="cornerButton(-1)" onClick="cornerButton(-1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajairetry.png"></input>

<input type ="image" class="tilebutton gray" id="solvedsavebutton" style="bottom:-50px;left:100px;position:fixed;background-color:#1212FF;transform: scale(0.475)" onClick="saveBox()" onClick="cornerButton(-1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaisave.png"></input>

</div>


<div id="savedmenu" style="overflow-x:hidden;display:none" class="center">
<h1 id="savetexttitle" style="font-size:64px">Saved Boxes</h1>

<div id="saverow" style="display:flex;width:500px;height:95px;background-color:#21314E" class="center">
<button style="width:250px;height:75px;background-color:#5683EA;color:#FFFFFF;margin-left:10px;margin-top:10px;margin-bottom:10px;margin-right:5px;font-size:48px;border:2px solid #FFFFFF" onClick="loadSavedMenu();">Created</button>
<button style="width:250px;height:75px;background-color:#61C357;color:#FFFFFF;margin-right:10px;margin-top:10px;margin-bottom:10px;margin-left:5px;font-size:48px;border:2px solid #FFFFFF" onClick="loadSavedMenu('solved');">Solved</button>
</div><br>
<p id="savetextcategory" style="font-size:48px">Created Boxes</p>
<p id="savetextwarn" style="font-size:32px">You don't have any saved boxes</p>
<br><br>

<div id="saveboxtemplate" style="position:relative;height:550px;width:85%;background-color:#40558B;left:20px;margin-bottom:25px;overflow:hidden;display:none">
<div id ="saveboxfakebox" style="position:relative;overflow-x:hidden;width:1024px;height:1024px;display:flex;right:205px;bottom:235px;transform: scale(0.5)" class="noHover">
<img src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaibox.png"></img>


<input type ="image" class="tilebutton green" style="top:214px;right:804px"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton red"style="top:214px;right:776px" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton black" style="top:214px;right:749px;transform: scaleX(-1)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<br>
<input type ="image" class="tilebutton white"  style="top:425px;right:1331px" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton violet" style="top:425px;right:1303px" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton yellow" style="top:425px;right:1276px;" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<br>
<input type ="image" class="tilebutton orange"  style="top:635px;right:1859px;transform: rotate(-90deg)" onClick="tilePress(2, 0)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton pink" style="top:635px;right:1831px" onClick="tilePress(2, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton blue" style="top:635px;right:1804px;transform: scaleX(-1) rotate(-90deg)" onClick="tilePress(2, 2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>

<img class="cornercircle white noHover" style="top:767px;right:2542px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img class="cornercircle white noHover" style="top:767px;right:2042px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img class="cornercircle white noHover" style="top:62px;right:2930px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img class="cornercircle white noHover" style="top:62px;right:2430px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>


<input type ="image" class="cornercircle white"style="top:58px;right:3323px;transform: scale(0.9) rotate(135deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image" class="cornercircle white" style="top:58px;right:2820px;transform: scale(0.9) rotate(-135deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image" class="cornercircle white" style="top:768px;right:3712px;transform: scale(0.9) rotate(45deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image" class="cornercircle white" style="top:768px;right:3210px;transform: scale(0.9) rotate(-45deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>

</div>


<h1 id="saveboxfakename" style="font-size:100px;position:relative;left:570px;bottom:1075px;max-width:1050px;text-align:left">Untitled Box</h1>
<p id="saveboxdescription" style="font-size:48px;position:relative;left:570px;bottom:1075px;max-width:1050px;text-align:left;display:none">The classic variation</p>



<input type="text" id ="saveboxfakecode" readonly style="position:absolute;left:600px;top:250px;width:850px;height:45px;font-size:32px;background-color:#252525;color:#FFFFFF;text-align:left" value="CodeCodeCodeCodeCode"></input>


<div id="saveboxfakeplayrow" style="display:flex;position:absolute;left:80%;bottom:0px">
<input type="image" id="fakedeletebutton" style="height:98px;width:98px;background-color:#68352D;margin:5px;border:3px solid #121212" onClick="saveBoxSelect('delete')" class="blankColor" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitrash.png"></input>
<input type="image" id="fakeplaybutton" style="height:98px;width:98px;background-color:#21314E;margin:5px;border:3px solid #121212" onClick="saveBoxSelect('load')" class="blankColor" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiplay.png"></input>
</div>

</div>

</div>

<div id="presetsmenu" style="overflow-x:hidden;display:none" class="center">
<h1 id="presettitle" style="font-size:64px">Box Presets</h1>



</div>



<br><br><br><br><br><br>

<div id="box" style="overflow-x:hidden;width:1024px;height:1024px;display:flex;left:0px" class="center">
<img src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaibox.png"></img>


<input type ="image" class="tilebutton green" id="tile0;0" style="top:214px;right:804px" onClick="tilePress(0, 0)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton red" id="tile0;1" style="top:214px;right:776px" onClick="tilePress(0, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton black" id="tile0;2" style="top:214px;right:749px;transform: scaleX(-1)" onClick="tilePress(0, 2)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<br>
<input type ="image" class="tilebutton white" id="tile1;0" style="top:425px;right:1331px" onClick="tilePress(1, 0)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton violet" id="tile1;1" style="top:425px;right:1303px" onClick="tilePress(1, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton yellow" id="tile1;2" style="top:425px;right:1276px;" onClick="tilePress(1, 2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<br>
<input type ="image" class="tilebutton orange" id="tile2;0" style="top:635px;right:1859px;transform: rotate(-90deg)" onClick="tilePress(2, 0)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton pink" id="tile2;1" style="top:635px;right:1831px" onClick="tilePress(2, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton blue" id="tile2;2" style="top:635px;right:1804px;transform: scaleX(-1) rotate(-90deg)" onClick="tilePress(2, 2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>

<img id="corner2" class="cornercircle white noHover" style="top:767px;right:2542px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img id="corner3" class="cornercircle white noHover" style="top:767px;right:2042px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img id="corner0" class="cornercircle white noHover" style="top:62px;right:2930px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img id="corner1" class="cornercircle white noHover" style="top:62px;right:2430px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>


<input type ="image"id="cornerbutton0" class="cornercircle white" onClick="cornerButton(0)" style="top:58px;right:3323px;transform: scale(0.9) rotate(135deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image"id="cornerbutton1" class="cornercircle white" onClick="cornerButton(1)" style="top:58px;right:2820px;transform: scale(0.9) rotate(-135deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image"id="cornerbutton2" class="cornercircle white" onClick="cornerButton(2)" style="top:768px;right:3712px;transform: scale(0.9) rotate(45deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image"id="cornerbutton3" class="cornercircle white" onClick="cornerButton(3)" style="top:768px;right:3210px;transform: scale(0.9) rotate(-45deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
</div>

<h1 style="text-align:center;font-size:64px;left:0px;position:relative" id="boxname">Custom Box</h1>

<div id="editmenu" style="position:fixed;margin:auto;overflow-y:scroll;overflow-x:hidden;top:0;bottom:0;right:0%;height:100%;width:550px;background-color:#344D7E;display:none">
<br><br><br><br><br><br><br>
<h1 style="font-size:48px" id="editorstatus"> Currently: Testing </h1>

<div id="buttonrow" style="display:flex;margin:auto;top:0;left:162px;position:relative;right:0;bottom:0;" class="center">
<input type="image" style="height:98px;width:98px;background-color:#21314E;margin:5px;border:3px solid #121212" onClick="editorSelect('play')" class="blankColor" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiplay.png"></input>
<input type="image" style="height:98px;width:98px;background-color:#21314E;margin:5px;border:3px solid #121212" onClick="editorSelect('edit')" class="blankColor" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiedit.png"></input>
</div>
<br><br><br>
<h1>Selected</h1>
<img type ="image" class="tilebutton gray noHover" id="editColor" style="border:7px solid #121212" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<br><br>

<div id="colorrow" style="display:flex;margin:auto;top:0;left:83px;position:relative;right:0;bottom:0;" class="center">
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton gray"onClick="editorSelect(0)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton white"onClick="editorSelect(1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
</div><br>
<div id="colorrow" style="display:flex;margin:auto;top:0;left:83px;position:relative;right:0;bottom:0;" class="center">
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton green"onClick="editorSelect(2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton black"onClick="editorSelect(3)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
</div><br>
<div id="colorrow" style="display:flex;margin:auto;top:0;left:83px;position:relative;right:0;bottom:0;" class="center">
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton yellow"onClick="editorSelect(5)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton violet"onClick="editorSelect(4)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
</div><br>
<div id="colorrow" style="display:flex;margin:auto;top:0;left:83px;position:relative;right:0;bottom:0;" class="center">
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton pink"onClick="editorSelect(6)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton orange"onClick="editorSelect(7)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
</div><br>
<div id="colorrow" style="display:flex;margin:auto;top:0;left:83px;position:relative;right:0;bottom:0;" class="center">
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton red"onClick="editorSelect(8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" style="margin:5px;border:4px solid #000000" class="tilebutton blue"onClick="editorSelect(9)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
</div><br>
</div>


<div id="savemenu" class = "center" style="z-index:5;height:850px;top:150px;width:1200px;background-color: #121212;display:block;position:fixed;border:5px solid #FFFFFF;overflow-y:hidden;display:none">
<div id="boxnamingmenu" style="display:flex;text-align:center">
<h1 style="position:relative;font-size:64px;left:50px" id="saveboxname">Saving Box:</h1>
<input type="text" id="saveboxchangename" onchange ="saveboxNameChange();" onkeypress="this.onchange()" oninput = "this.onchange()" oninput = "this.onchange();"  maxlength="25" style="position:relative;left:95px;top:55px;width:700px;height:45px;font-size:32px"></input>
</div>

<div id ="savebox" style="position:relative;overflow-x:hidden;width:1024px;height:1024px;display:flex;right:125px;bottom:250px;transform: scale(0.5)" class="noHover">
<img src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaibox.png"></img>


<input type ="image" class="tilebutton green" style="top:214px;right:804px"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton red"style="top:214px;right:776px" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton black" style="top:214px;right:749px;transform: scaleX(-1)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<br>
<input type ="image" class="tilebutton white"  style="top:425px;right:1331px" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton violet" style="top:425px;right:1303px" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton yellow" style="top:425px;right:1276px;" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<br>
<input type ="image" class="tilebutton orange"  style="top:635px;right:1859px;transform: rotate(-90deg)" onClick="tilePress(2, 0)"  src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>
<input type ="image" class="tilebutton pink" style="top:635px;right:1831px" onClick="tilePress(2, 1)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></input>
<input type ="image" class="tilebutton blue" style="top:635px;right:1804px;transform: scaleX(-1) rotate(-90deg)" onClick="tilePress(2, 2)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicornertile.png"></input>

<img class="cornercircle white noHover" style="top:767px;right:2542px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img class="cornercircle white noHover" style="top:767px;right:2042px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img class="cornercircle white noHover" style="top:62px;right:2930px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>
<img class="cornercircle white noHover" style="top:62px;right:2430px;transform: scale(0.95)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaicirclecorner.png"></img>


<input type ="image" class="cornercircle white"style="top:58px;right:3323px;transform: scale(0.9) rotate(135deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image" class="cornercircle white" style="top:58px;right:2820px;transform: scale(0.9) rotate(-135deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image" class="cornercircle white" style="top:768px;right:3712px;transform: scale(0.9) rotate(45deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
<input type ="image" class="cornercircle white" style="top:768px;right:3210px;transform: scale(0.9) rotate(-45deg)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiblue_off.png"></input>
</div>

<p style="position:relative;font-size:64px;bottom:1050px;left:680px;max-width:400px">This box will be saved to your [Saved] menu, and can be accessed at any time</p>
<br>
<input type="text" id ="savecode" readonly style="position:relative;right:130px;bottom:1050px;min-width:900px;max-width:900px;height:45px;font-size:32px;background-color:#252525;color:#FFFFFF" value="whats the science"></input>
<br>
<button id="savecopybutton" onClick="copyCode()" style="position:relative;left:455px;bottom:1098px;width:250px;height:45px;font-size:32px;background-color:#FFFFFF;color:#000000">Copy</button>
<br>
<button id="finishsavebutton" onClick="finishBox()" style="position:relative;left:0px;bottom:1080px;width:750px;height:45px;font-size:32px;background-color:#FFFFFF;color:#000000">Save!</button>

</div>

<div id="loadmenu" class = "center" style="z-index:5;height:350px;top:150px;width:800px;background-color: #121212;display:none;position:fixed;border:5px solid #FFFFFF;overflow-y:hidden;">
<h1 style="font-size:64px;" id="saveboxname">Load Box</h1>
<p style="font-size:32px;display:none" id="loaderror">There was an error loading this box</p>
<input type="text" id="boxloadinput" placeholder="Enter Box Code" style="width:700px;height:45px;font-size:32px"></input><br><br>
<button id="finishsavebutton" onClick="loadBox()" style="width:550px;height:45px;font-size:32px;background-color:#FFFFFF;color:#000000">Load</button>
</div>


<div id="helpmenu" class = "center" style="height:1200px;width:800px;background-color: #121212;display:none;position:fixed;z-index:7;top:125px">
<h1 style="font-size:48px">Warning!! This will contain spoilers for Blue Prince</h1><br><br>
<img  class="center" style="height:960px;position:relative;margin:auto" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaihelp.png"></img><br>
<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton gray noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Gray Tiles</h2>
<p style="position:relative;bottom:0px;right:768px;top:50px;font-size:20px;min-width:600px;max-height:100px;">Gray Tiles have no effect when pressed.</p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton white noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">White Tiles</h2>
<p style="position:relative;bottom:0px;right:780px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, turns itself Gray, all adjacent Gray tiles White, and adjacent White tiles Gray. </p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton green noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Green Tiles</h2>
<p style="position:relative;bottom:0px;right:780px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, this tile will swap places with the tile in the opposite position on the grid. Does nothing when in the middle position.</p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton black noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Black Tiles</h2>
<p style="position:relative;bottom:0px;right:780px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, this tile will shift the entire row to the right, wrapping around the edge (The right-most tile becomes left).</p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton yellow noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Yellow Tiles</h2>
<p style="position:relative;bottom:0px;right:786px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, this tile will move north (up), swapping place with the tile currently above it. Does nothing if at the top.</p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton violet noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Violet Tiles</h2>
<p style="position:relative;bottom:0px;right:780px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, this tile will move south (down), swapping place with the tile currently below it. Does nothing if at the bottom.</p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton pink noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Pink Tiles</h2>
<p style="position:relative;bottom:0px;right:760px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, all adjacent (including diagonally adjacent) tiles will rotate clockwise around the tile, wrapping around at the edges.</p>
</div>

<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton orange noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Orange Tiles</h2>
<p style="position:relative;bottom:0px;right:800px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, this tile's color will change to the one shared by the majority of adjacent tiles.</p>
</div>


<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton red noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Red Tiles</h2>
<p style="position:relative;bottom:0px;right:760px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, all White tiles on the grid become Black, and all Black Tiles will become Red.</p>
</div>


<hr>
<div style="display:flex;text-align:left">
<img class="tilebutton blue noHover" style="margin-right:auto;transform: scale(0.8)" src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaitile.png"></img>
<h2 style="margin-right:80%;font-size:32px;white-space: nowrap;height:50%">Blue Tiles</h2>
<p style="position:relative;bottom:0px;right:760px;top:50px;font-size:20px;min-width:600px;max-height:100px;">When pressed, this tile will mimic the effect of the tile in the center of the grid. Does nothing if the center tile is Blue.</p>
</div>

<br><br><br>
<hr>
<h1 style="font-size:64px;">Editing</h1>
<p style="font-size:28px;color:white;text-align:left">Editing is fairly simple on here!</p>
<p style="font-size:28px;color:red">[Please note that editing a box will override it, so if you edit a box you're already playing, solving it will not save your progress!]</p>
<ul style="font-size:28px;text-align:left">
 <li>First, press the Blue Edit Button at the top of the screen to open the Edit Menu.</li>
 <li>Secondly, press the Edit Button to enter edit mode, where you can select tile colors and such.</li>
 <li>While in edit mode, pressing on a tile will change it to the selected colour, and pressing a corner tile will also change its color, pretty simple.</li>
 <li>After solving your box, you get the option to save it! (By clicking on the Disk/Save icon).</li>
 <li>When saving your box and naming your box you get its <b>code</b>. You can copy this code and send it to other for them to try your awesome new box!</li>
 <li>All your saved boxes will be accessible in the [Saved] tab, where you can see their code, and play them if you want.</li>
</ul>

<br>
<hr>
<h1 style="font-size:64px;">Loading</h1>
<p style="font-size:28px;color:white;text-align:left">Box codes, which are made from saving a box can be inputted to the [Load] menu, where you can play them! All solved boxes are also saved in the [Saved] tab, where you can check their codes and play them again.</p><br>
<div style="display:flex">
<p style="font-size:28px;color:white;text-align:left">Box codes will look like this:</p>
<input type="text" id ="saveboxfakecode" readonly style="position:relative;top:18px;left:15px;width:385px;height:45px;font-size:32px;background-color:#252525;color:#FFFFFF;text-align:left" value="MTs0OzM7MDsyOzA7Mzs0OzEvMDswOzA7MC9UaGUgR3JheSBCb3g="></input>
</div>

</div>

<script>
const Tiles = Object.freeze({
     GRAY: 0,
     WHITE: 1,
     GREEN: 2,
     BLACK: 3,
     VIOLET: 4,
     YELLOW: 5,
     PINK: 6,
     ORANGE: 7,
     RED: 8,
     BLUE: 9

});

var grid = [[Tiles.WHITE, Tiles.GRAY, Tiles.WHITE], [Tiles.WHITE, Tiles.GRAY, Tiles.GRAY], [Tiles.GRAY, Tiles.GRAY, Tiles.WHITE]];
var startingGrid = JSON.parse(JSON.stringify(grid));
var colorsNeeded = [1, 1, 1, 1];
var onColors = [false, false, false, false];
var solved = false;

var currentBoxData = ["The Mora Jai Box", "MTswOzE7MTswOzA7MDswOzEvMTsxOzE7MS9UaGUgTW9yYSBKYWkgQm94"];//Name, Code
var editorState = "play";
var editorColor = 0;


function tilePress(y, x, tileColor = grid[y][x]) {
  if (editorState == "edit") {
     startingGrid[y][x] = editorColor;
     cornerButton(-1);
     return;

  }
  
  if (solved) {return;}
  
   var audio = new Audio('https://github.com/eestsoftware/MoraJaiBox/raw/refs/heads/main/audio/morajaitilepress.mp3');
   if (tileColor != 9) { audio.play(); }
 
  var selfColor = parseInt(grid[y][x]);//seperate from tileColor for blue tiles to work
  switch(tileColor) {
    case 0: break;
    case 1:
        let allowedColors = [0, selfColor];
        let convertTo = {0: selfColor, [selfColor]: 0};

        convertTile(y, x, allowedColors, convertTo);
        convertTile(y, x - 1, allowedColors, convertTo);
        convertTile(y, x + 1, allowedColors, convertTo);
        convertTile(y - 1, x, allowedColors, convertTo);
        convertTile(y + 1, x, allowedColors, convertTo);
        break;
    case 2:
        var oppositeX = 1;
        if (x == 2) {oppositeX = 0;} else if (x == 0) {oppositeX = 2;}
        var oppositeY = 1;
        if (y == 2) {oppositeY = 0;} else if (y == 0) {oppositeY = 2;}
        var oppositeTile = grid[oppositeY][oppositeX];
        grid[y][x] = oppositeTile;
        grid[oppositeY][oppositeX] = selfColor;
        break;
   case 3:
        var altGrid = [grid[y][2], grid[y][0], grid[y][1]];
        for (let i = 0; i < grid[y].length; i++) { grid[y][i] = altGrid[i]; }
        break;
   case 4:
        if (y >= grid.length - 1) {break;}
        var southTile = grid[y + 1][x];
        grid[y][x] = southTile;
        grid[y + 1][x] = selfColor;
        break;
    case 5:
        if (y <= 0) {break;}
        var northTile = grid[y - 1][x];
        grid[y][x] = northTile;
        grid[y - 1][x] = selfColor;
        break;
    case 6:
        let adjacentTiles = [[], [], []];//CODING THIS WAS TORTURE
        var i = 0;
        for (let rY = y - 1; rY < y + 2;rY++) { 
          if (rY < 0 || rY > grid.length - 1) {
            adjacentTiles[i] = [-1, -1, -1];
            i++;
            continue;
          }
          for (let rX = x - 1; rX < x + 2; rX++) {
            if (rX < 0 || rX > grid[rY].length - 1) {adjacentTiles[i].push(-1);continue;}
            adjacentTiles[i].push(grid[rY][rX]);
          }
          i++;
        }

        var nextTile = adjacentTiles[0][0];
         for (let rX = 0; rX < adjacentTiles[0].length; rX++) {
           var returnValue = rotateTile(rX, 0, nextTile, adjacentTiles);
           adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
         for (let rY = 1; rY < adjacentTiles.length; rY++) {
           var returnValue = rotateTile(2, rY, nextTile, adjacentTiles);
           adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
         for (let rX = 1; rX > -1; rX--) {
           var returnValue = rotateTile(rX, 2, nextTile, adjacentTiles);
          adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
         for (let rY = 1; rY > -1; rY--) {
           var returnValue = rotateTile(0, rY, nextTile, adjacentTiles);
           adjacentTiles =returnValue[0]
           nextTile = returnValue[1]
         }
        if (adjacentTiles[1][0] == -1 && y == 0) { adjacentTiles[1][2] = nextTile; } 
        else if (adjacentTiles[1][2] == -1 && y == 0) { adjacentTiles[2][1] = nextTile; }
        else if (adjacentTiles[0][1] == -1 && y == 0) { adjacentTiles[1][2] = nextTile; }

        i = 0;
        for (let rY = y - 1; rY < y + 2;rY++) { 
          if (rY < 0 || rY > grid.length - 1) {i++;continue;}
          var j = 0;
          for (let rX = x - 1; rX < x + 2; rX++) {
            if (rX < 0 || rX > grid[rY].length - 1) {j++;continue;}
            grid[rY][rX] = adjacentTiles[i][j];
            j++;
          }
          i++;
        }
        break;
     case 7:
        var neighbouringTiles = [];
        if (y > 0) {neighbouringTiles.push(grid[y - 1][x]);}
        if (y < grid.length - 1) {neighbouringTiles.push(grid[y + 1][x]);}
        if (x > 0) {neighbouringTiles.push(grid[y][x - 1]);}
        if (x < grid[y].length - 1) {neighbouringTiles.push(grid[y][x + 1]);}
        let popularity = {};
        for (let i = 0; i < neighbouringTiles.length; i++) {
          if (Object.keys(popularity).indexOf(neighbouringTiles[i].toString()) < 0) { popularity[neighbouringTiles[i]] = 0; }
          popularity[neighbouringTiles[i]]++;
        }

        var maximum = [0, selfColor]
        for (let i = 0; i < Object.keys(popularity).length; i++) {
         var tile = Object.keys(popularity)[i];
         if (popularity[tile] < maximum[0]) {continue;}
         else if (popularity[tile] == maximum[0]) {maximum[1] = selfColor;continue;}
          
         maximum[0] = popularity[tile];
         maximum[1] = parseInt(tile);
        }
        grid[y][x] = maximum[1];
        break;
      case 8:
        for (let i = 0; i < grid.length; i++) {
           for (let j = 0; j < grid[i].length; j++) {
             convertTile(j, i, [Tiles.WHITE, Tiles.BLACK], {1: 3, 3: selfColor});
           }
        }
        break;
      case 9:
         if (grid[1][1] == Tiles.BLUE) {return;}
         tilePress(y, x, grid[1][1]);
         return;
  }
  renderBox();
}

function convertTile(y, x, allowedColors, convertTo) {
  if (y >= grid.length || y < 0 || x >= grid[y].length || x < 0) {return;}
  var isColor = false;
  for (let i = 0; i < allowedColors.length; i++) {
    if (allowedColors.indexOf(grid[y][x]) < 0) {continue;}
    isColor = true;
    break;
  }
  if (!isColor) {return;}
  grid[y][x] = convertTo[grid[y][x]];
} 

function rotateTile(x, y, nextTile, adjacentTiles) {
    var xDir = 0;
    if (y == 0 && x< 2) {xDir = 1;}
    else if(y== 2 && x> 0) {xDir = -1;}
    var yDir = 0;
    if (x== 0 && y> 0) {yDir = -1;}
    else if(x== 2 && y< 2) {yDir = 1;}
             
    var tile = nextTile;
    nextTile = adjacentTiles[y+ yDir][x+ xDir]; 

    if (nextTile == -1) {nextTile = tile;tile = -1;}
    if (tile == -1) { return [adjacentTiles, nextTile];}
    adjacentTiles[y+ yDir][x+ xDir] = tile;
    return [adjacentTiles, nextTile];
}

function cornerButton(id) {
 if (id == -1) {
   solved = false;
   document.getElementById("savemenu").style.display = "none";
   document.getElementById("solved").style.display = "none";
 } else if (id >= 0 && editorState == "edit") {
   colorsNeeded[id] = editorColor;
   cornerButton(-1);
   return;
 }
 if (solved) {return;}
 var cornerTile = grid[id < 2 ? 0 : 2][id % 2 == 0 ? 0 : 2]

 if (id >= 0) {
   var audio = new Audio('https://github.com/eestsoftware/MoraJaiBox/raw/refs/heads/main/audio/' + ((cornerTile == colorsNeeded[id]) ? "morajaicornerbuttonpress.mp3" : "morajaireset.mp3"));
   audio.play();
 }
 
 if (cornerTile == colorsNeeded[id] && id >= 0) {
   var colorNames = Object.keys(Tiles);
   onColors[id] = true;
   solved = (onColors[0] && onColors[1] && onColors[2] && onColors[3]);
   document.getElementById("cornerbutton" + id).className = "cornercircle " + colorNames[colorsNeeded[id]].toLowerCase()
   document.getElementById("cornerbutton" + id).src = "https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajai" + colorNames[colorsNeeded[id]].toLowerCase() +  "_on.png"
   if (!solved) {return;}
   document.getElementById("solved").style.display = "block";
   document.getElementById("solved").className = colorNames[colorsNeeded[0]].toLowerCase();
   document.getElementById("solvedsavebutton").style.display = (currentBoxData[0] == "Custom Box") ? "block" : "none";
   document.getElementById("solvedtext").innerHTML = ((currentBoxData[0] == "Custom Box") ? "Box" : currentBoxData[0]) + " solved!!";
   
   var allCompleteBoxes = localStorage.getItem("completeBoxes");
   if (allCompleteBoxes == null) { allCompleteBoxes = []; }
   else {allCompleteBoxes = JSON.parse(localStorage.getItem("completeBoxes")); }

   if(allCompleteBoxes.indexOf(currentBoxData[1]) < 0 && currentBoxData[0] != "Custom Box" && currentBoxData[1] != "") {allCompleteBoxes.push(currentBoxData[1]); }
   localStorage.setItem("completeBoxes", JSON.stringify(allCompleteBoxes)); 
   return;
 }
 grid = JSON.parse(JSON.stringify(startingGrid));
 renderBox();
 setColors();
}


function renderBox() {
  setColors();
  var colorNames = Object.keys(Tiles);
  for (var y = 0; y < grid.length; y++) {
    for (var x = 0; x < grid[y].length; x++) {
      var tileColor = grid[y][x];
      document.getElementById("tile" + y + ";" + x).className = "tilebutton " + colorNames[tileColor].toLowerCase();
   }
  }
}

function setColors() {
 var colorNames = Object.keys(Tiles);
 onColors = [false, false, false, false];
 for (let i = 0; i < colorsNeeded.length; i++) {
   document.getElementById("corner" + i).className = "cornercircle " + colorNames[colorsNeeded[i]].toLowerCase() + " noHover"
   document.getElementById("cornerbutton" + i).className = "cornercircle blankColor"
   document.getElementById("cornerbutton" + i).src = "https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajai" + colorNames[colorsNeeded[i]].toLowerCase() +  "_off.png"
 } 
}


setColors();
renderBox();
document.getElementById("boxname").innerHTML = currentBoxData[0];

function editorSelect(action) {
  if (action == "play" || action == "edit") {
     cornerButton(-1);
     if (action == "edit") {currentBoxData = ["Custom Box", ""]; }
     editorState = action
     document.getElementById("boxname").innerHTML = currentBoxData[0] + ((editorState == "edit") ? " [EDITING]" : "");
     document.getElementById("editorstatus").innerHTML = "Currently: " + ((editorState == "play") ? "Testing" : "Editing");
     return;
  }
  if (editorState == "play") {return;}
  var colorNames = Object.keys(Tiles);
  editorColor = action;
  document.getElementById("editColor").className = "tilebutton " + colorNames[action].toLowerCase() + " noHover";
}

function updateBoxCode() {
  var code = "";
  for (let i = 0; i < startingGrid.length; i++) {
      for (let j = 0; j < startingGrid[i].length; j++) {
        code += startingGrid[i][j];
        if (!(i == startingGrid.length - 1 && j == startingGrid[i].length - 1)) {code += ";";}
      }
  }
  code += "/";
  for (let i = 0; i < colorsNeeded.length; i++) {
    code += colorsNeeded[i];
    if (i < 3) {code += ";";}
   }
  var name = currentBoxData[0].trim();
  if (name == "" || name.length < 1 || name == "Custom Box") {name = "Untitled Box";}
  currentBoxData[0] = name;  

  code += ("/" + name);
  code = btoa(code);
  currentBoxData[1] = code;
  document.getElementById("savecode").value = code;
}

function copyCode() {
  navigator.clipboard.writeText(document.getElementById("savecode").value);
  document.getElementById("savecopybutton").innerHTML = "Copied!"
  setTimeout(() => { document.getElementById("savecopybutton").innerHTML = "Copy"; }, 500);
}

function saveBox() {
  document.getElementById("savemenu").style.display = (document.getElementById("savemenu").style.display == "block") ? "none" : "block";
  colorFakeBox(document.getElementById("savebox"), startingGrid, colorsNeeded);
  updateBoxCode();
}

function finishBox() {
  cornerButton(-1);
  var allSavedBoxes = localStorage.getItem("savedBoxes");
  if (allSavedBoxes == null) { allSavedBoxes = {}; }
  else {allSavedBoxes = JSON.parse(localStorage.getItem("savedBoxes")); }

  var boxName = currentBoxData[0];
  if (Object.values(allSavedBoxes).indexOf(currentBoxData[1]) >= 0) {return;}
  if (Object.keys(allSavedBoxes).indexOf(boxName) >= 0) { 
    var newName = boxName;
    var i = 1;
    while(Object.keys(allSavedBoxes).indexOf(newName) >= 0) {
      newName = boxName + " (" + i + ")";
      i += 1;
    }
    boxName = newName;
  }
  currentBoxData[0] = boxName;
  document.getElementById("boxname").innerHTML = currentBoxData[0] + ((editorState == "edit") ? " [EDITING]" : "");

  allSavedBoxes[boxName] = currentBoxData[1];
  localStorage.setItem("savedBoxes", JSON.stringify(allSavedBoxes));
}

function saveboxNameChange() {
  currentBoxData[0] = document.getElementById("saveboxchangename").value;
  updateBoxCode();
}

function getBoxDataFromCode(input) {
  var code = atob(input);
  code = code.split("/");

  var gridCode = code[0].split(";");
  for (var i = 0; i < gridCode.length; i++) {gridCode[i] = parseInt(gridCode[i]); }

  var newGrid = [[gridCode[0], gridCode[1], gridCode[2]], [gridCode[3], gridCode[4], gridCode[5]], [gridCode[6], gridCode[7], gridCode[8]]]
  var newColors = code[1].split(";");
  for (var i = 0; i < newColors.length; i++) {newColors[i] = parseInt(newColors[i]); }

  var boxData = [code[2], input];
  return [newGrid, newColors, boxData];
}

function loadBox(input = document.getElementById("boxloadinput").value) {
  try {
  var boxData = getBoxDataFromCode(input);

  startingGrid = JSON.parse(JSON.stringify(boxData[0]));
  colorsNeeded = boxData[1];
  currentBoxData = boxData[2];
  document.getElementById("boxname").innerHTML = currentBoxData[0];
  } catch(error) {
   document.getElementById("loaderror").style.display = "block";
   return;
  }
  document.getElementById("loaderror").style.display = "none";
  renderBox();
  cornerButton(-1);
  showMenu("");
  solved = false;
}

function loadPresetsMenu() {
   var menu = document.getElementById("presetsmenu");
   var children = menu.childNodes;
   removeCategoryChildren(children);
   menu.innerHTML = '<h1 id="presettitle" style="font-size:64px">Box Presets</h1>';   

   var template = document.getElementById("saveboxtemplate");
   var allPresets = {"The Mora Jai Box": "MTswOzE7MTswOzA7MDswOzEvMTsxOzE7MS9UaGUgTW9yYSBKYWkgQm94", "Advanced Mora Jai": "MDsxOzQ7MDsxOzE7MzsxOzUvMTsxOzE7MS9BZHZhbmNlZCBNb3JhIEphaQ==", "Blackout!": "MDs0OzM7MzswOzM7Mzs1OzAvMzszOzM7My9CbGFja291dCE=", "Upwarp": "NDsyOzA7MzswOzQ7MDs0OzQvNDs0OzQ7NC9VcHdhcnA=", "A More Nuanced Box": "MTsyOzM7MTs3OzA7Mjs1OzcvMjsyOzI7Mi9BIE1vcmUgTnVhbmNlZCBCb3g=", "Up North Trip": "NTswOzM7MDsyOzU7Mjs3OzUvNTs1OzU7NS9VcCBOb3J0aCBUcmlw", "Red Threat": "MzswOzU7MTs4OzE7MDs0OzUvODs4Ozg7OC9SZWQgVGhyZWF0", "The Rotunda": "NzswOzA7NjszOzY7MDswOzcvNjs2OzY7Ni9UaGUgUm90dW5kYQ==", "A New Hue": "MDswOzA7MDsyOzM7OTs1OzEvOTs5Ozk7OS9BIE5ldyBIdWU=", "Orange Mayhem": "Nzs5OzQ7MDszOzA7Mjs5OzcvNzs3Ozc7Ny9PcmFuZ2UgTWF5aGVt"};


   var descriptions = {"The Mora Jai Box": "The classic variation, features only simple White and Gray tiles, nothing else.", "Advanced Mora Jai": "The Classic Box, but with a few twists! Includes 3 new tiles from 3 different regional variations.", "Blackout!": "A simpler box featuring the Black Tiles, without any White Tiles to be found!", "A More Nuanced Box": "Featuring the Green and Orange tiles! Quite a botanical looking box.", "Red Threat": "An introduction to the Red Tiles, find a way to spread them to the corners!", "The Rotunda": "Featuring the Pink tiles, which rotate everything around them clockwise. Twist and turn your way to the solution.", "Up North Trip": "A box focues on those Yellow tiles, you know them, they always move up!", "Upwarp": "Simple box featuring the Violet tiles, with a guest appearance from the Green tile.", "Orange Mayhem": "The most complicated box yet. This one will be sure to test your knowledge of the msot essential tiles.", "A New Hue": "A box featuring Blue?? Tiles!! Figure out their utility and spread them across the four corners."}

   for (let i = 0; i < Object.keys(allPresets).length; i++) {
     var clone = template.cloneNode(true);
     menu.appendChild(clone);
     clone.style.display = "block";
     clone.id="savedboxcontainer" + i;
     var subElements = clone.childNodes;
     clone.querySelector('#saveboxfakename').innerHTML = Object.keys(allPresets)[i];
     clone.querySelector('#saveboxfakecode').remove();
     clone.querySelector('#saveboxdescription').style.display = "block";
     clone.querySelector('#saveboxdescription').innerHTML = descriptions[Object.keys(allPresets)[i]];
     clone.querySelector('#saveboxfakeplayrow #fakeplaybutton').setAttribute( "onClick", "saveBoxSelect('load', '" + allPresets[Object.keys(allPresets)[i]] + "')");
     clone.querySelector('#saveboxfakeplayrow #fakedeletebutton').style.visibility = "hidden";
     clone.style['background-color'] = "#78CC70";
     try {
     var boxData = getBoxDataFromCode(allPresets[Object.keys(allPresets)[i]]);
     colorFakeBox(clone.querySelector('#saveboxfakebox'), boxData[0], boxData[1]);
     } catch(error) {
      console.log(error);
      clone.remove()
      continue;
     }
   }
}

function removeCategoryChildren(children) {
  for (let i = 0; i < children.length; i++) {
     if (children[i].id == "saveboxtemplate" || (children[i].id != "" && children[i].id != null && children[i].id.includes("savetext")) || children[i].id == "saverow" || children[i].id == "presettitle") {continue;}
     children[i].remove();
   } 
}

function loadSavedMenu(category = "created") {
   var menu = document.getElementById("savedmenu");
   var children = menu.childNodes;
    removeCategoryChildren(children);
     removeCategoryChildren(children);

   var template = document.getElementById("saveboxtemplate");
   var allSavedBoxes = {};

   if (category == "created") {
   allSavedBoxes = localStorage.getItem("savedBoxes");
   if (allSavedBoxes == null) { allSavedBoxes = {}; }
   else {allSavedBoxes = JSON.parse(localStorage.getItem("savedBoxes")); }
   } else {
     var allSolved = localStorage.getItem("completeBoxes");
     if (allSolved == null) { allSolved = []; }
      else {allSolved = JSON.parse(localStorage.getItem("completeBoxes")); }
      for (let i = 0; i < allSolved.length; i++) {
        try {
        var boxName = atob(allSolved[i]).split("/")[2];
        allSavedBoxes[boxName] = allSolved[i];
        } catch(error) { continue; }
      }
    }
  
   document.getElementById("savetextcategory").innerHTML = (category == "created") ? "Created Boxes" : "Solved Boxes";
   document.getElementById("savetextwarn").style.display = (Object.keys(allSavedBoxes).length <= 0) ? "block" : "none";

   for (let i = 0; i < Object.keys(allSavedBoxes).length; i++) {
     var clone = template.cloneNode(true);
     menu.appendChild(clone);
     clone.style.display = "block";
     clone.id="savedboxcontainer" + i;
     var subElements = clone.childNodes;
     clone.querySelector('#saveboxfakename').innerHTML = Object.keys(allSavedBoxes)[i];
     clone.querySelector('#saveboxfakecode').value = allSavedBoxes[Object.keys(allSavedBoxes)[i]];
     clone.querySelector('#saveboxfakeplayrow #fakeplaybutton').setAttribute( "onClick", "saveBoxSelect('load', '" + allSavedBoxes[Object.keys(allSavedBoxes)[i]] + "')");
     clone.querySelector('#saveboxfakeplayrow #fakedeletebutton').setAttribute( "onClick", "saveBoxSelect('delete', '" + ((category == "created") ? Object.keys(allSavedBoxes)[i] : allSavedBoxes[Object.keys(allSavedBoxes)[i]])  + "')");
     try {
     var boxData = getBoxDataFromCode(allSavedBoxes[Object.keys(allSavedBoxes)[i]]);
     colorFakeBox(clone.querySelector('#saveboxfakebox'), boxData[0], boxData[1]);
     } catch(error) {
      console.log(error);
      clone.remove()
      continue;
     }
   }
}

function saveBoxSelect(action, code) {
  switch(action) {
     case "load":
        loadBox(code);
        break;
     case "delete":
        var name = code;
        
         var template = document.getElementById("saveboxtemplate");
         var allSavedBoxes = localStorage.getItem("savedBoxes");
         if (allSavedBoxes == null) { allSavedBoxes = {}; }
         else {allSavedBoxes = JSON.parse(localStorage.getItem("savedBoxes")); }
         
         var category = "created";
         if (Object.keys(allSavedBoxes).indexOf(name) >= 0) {
         delete allSavedBoxes[name]; 
         console.log(allSavedBoxes);
         localStorage.setItem("savedBoxes", JSON.stringify(allSavedBoxes));
 
         } else {  
           allSavedBoxes = JSON.parse(localStorage.getItem("completeBoxes"));
           allSavedBoxes.splice(allSavedBoxes.indexOf(name), 1);
           localStorage.setItem("completeBoxes", JSON.stringify(allSavedBoxes));
           category = "solved";
         }

         var menu = document.getElementById("savedmenu");
         var children = menu.childNodes;
          removeCategoryChildren(children);

         loadSavedMenu(category);
        break;
  }
}

function showMenu(menu) {
  var allMenus = ["edit", "presets", "saved"];
  var smallMenus = ["help", "load"]
  if (smallMenus.indexOf(menu) < 0 || menu == "") {
     for (var i = 0; i < allMenus.length; i++) {
      if ((allMenus[i] != menu)) {  document.getElementById(allMenus[i] + "menu").style.display = "none"; }
      if (allMenus[i] != menu) {continue;}
      document.getElementById(allMenus[i] + "menu").style.display = (document.getElementById(allMenus[i] + "menu").style.display != "block") ? "block" : "none";
     }
  }
  if (allMenus.indexOf(menu) < 0 || menu == "" ) {
    for (var i = 0; i < smallMenus.length; i++) {
      if ((smallMenus[i] != menu)) {  document.getElementById(smallMenus[i] + "menu").style.display = "none"; }
      if (smallMenus[i] != menu) {continue;}
      document.getElementById(smallMenus[i] + "menu").style.display = (document.getElementById(smallMenus[i] + "menu").style.display != "block") ? "block" : "none";
    }
  }
  document.getElementById("box").style.left = (document.getElementById("editmenu").style.display == "block") ? "-250px" : "0px"
  document.getElementById("boxname").style.left = (document.getElementById("editmenu").style.display == "block") ? "-250px" : "0px"
  document.getElementById("box").style.visibility = (document.getElementById("presetsmenu").style.display == "none" && document.getElementById("savedmenu").style.display == "none") ? "visible" : "hidden";
  document.getElementById("boxname").style.display = (document.getElementById("presetsmenu").style.display == "none" && document.getElementById("savedmenu").style.display == "none") ? "block" : "none";
  if (menu == "saved") { loadSavedMenu(); }
  else if (menu == "presets") { loadPresetsMenu(); }
}

function colorFakeBox(box, bGrid, colors) {
  var nodes = box.getElementsByTagName("*");
  var colorNames = Object.keys(Tiles);

  let y = 0;
  let x = 0;
  let i = 0;
  for (let j = 0; j < nodes.length; j++) {
    if(nodes[j].className == "") {continue;}
    if (i < 9) {
      nodes[j].className = "tilebutton " + colorNames[bGrid[y][x]].toLowerCase();
      x += 1;
      if (x % 3 == 0 && x > 0) {
         y += 1;
         x = 0;
       }
    } else if (i < 13) {
      nodes[j].className = "cornercircle " + colorNames[colors[x]].toLowerCase() + " noHover";
      x += 1;
      if (i == 12) {x = 0;}
    } else {
      nodes[j].className = "cornercircle blankColor"
      nodes[j].src = "https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajai" + colorNames[colors[x]].toLowerCase() +  "_off.png"
    }
    i += 1;
  }
}
</script>

<br><p style="position:fixed;bottom:-1%;background-color: #272727;width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis"> <img src="https://raw.githubusercontent.com/eestsoftware/MoraJaiBox/refs/heads/main/images/morajaiboxico.png" height="16px"width="16px;"></img>
 eestsoftware 2025 ; mora jai box editor ; the mora jai boxes are from Blue Prince by Dogubomb, I am not affiliated with Dogubomb nor Raw Fury. This is simply a fan-made site. This text goes pretty long eh? Impressive that you're reading this. Eestsoftware has more sites than this you know.. But I'm impressed with your "reading this thin line of text skill though." Have a free puzzle: [MDs4OzA7MzswOzU7OTsyOzEvOTs5Ozk7OS8oYm9udXMpIEZvdXIgQ29ybmVycw==] </p>

</body>
</html>
